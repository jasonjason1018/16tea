{% extends './_layouts/_layout.tmpl' %}

{% block logo %}
<a href="{{ '/index.html' | relativePath }}">
    <img src="{{ '/assets/image/layout/logo.png' | relativePath }}" alt="">
</a>
<div class="header-subject">
    <img src="{{ '/assets/image/layout/subject-wt.png' | relativePath }}" alt="">
</div>
{% endblock %}

{% block content %}
<main class="main -f02">
    <div class="step">
        <div class="step-item -active" data-step="intro">
            <div class="intro">
                <div class="intro-wrap">
                    <div class="intro-tit">霧影森林</div>
                    <div class="intro-txt">
                        午後森林被柔霧輕擁<br>
                        透著暖陽的金色光輝<br>
                        這裡藏著有益健康、開胃助消化的食穀<br>
                        快來尋找收集吧！
                    </div>
                    <div class="intro-16">
                        {%- for item in range(0, 16) %}
                        <img src="./../assets/image/other/16/{{loop.index}}.png" class="intro-item" alt="">
                        {%- endfor %}
                    </div>
                </div>
                <button class="intro-btn" data-step-btn="task"></button>
            </div>
        </div>
        <div class="step-item" data-step="task">
            <div class="card -task">
                <div class="card-wrap">
                    <div class="task">
                        <div class="task-tit">
                            請在限時30秒內<br>
                            完成收集以下食穀與數量
                        </div>
                        <div class="task-content">
                            <div class="task-item">
                                <img class="task-pic" src="./../assets/image/map2/1.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">麥芽</div>
                                    <div class="task-desc">消化神助攻，順暢又健康</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="./../assets/image/map2/2.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">黑米</div>
                                    <div class="task-desc">營養在線負擔不見，誰吃誰健康</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="./../assets/image/map2/3.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">大麥</div>
                                    <div class="task-desc">止渴有一套，清爽好消化</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="./../assets/image/map2/4.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">玉蜀黍</div>
                                    <div class="task-desc">香甜不膩人，還能默默幫腸胃<br>加速</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="./../assets/image/map2/5.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">香菇</div>
                                    <div class="task-desc">樸實外表下藏著鮮美香氣與營養<br>實力</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="./../assets/image/map2/6.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">柿葉</div>
                                    <div class="task-desc">柿半功倍，日常保健不費力</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                        </div>
                        <div class="task-action">
                            <button class="btn" data-step-btn="instruction">開始挑戰</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="step-item" data-step="instruction">
            <div class="game -instruction" data-step-btn="game">
                <div class="game-content">
                    <div class="instruction">
                        <div class="instruction-time">
                            <div class="instruction-triangle"></div>
                            <span>限時30秒</span>
                        </div>
                        <div class="instruction-click">
                            <img src="./../assets/image/map2/instruction/item.png" alt="">
                            <div class="instruction-finger -c">
                                <div></div>
                            </div>
                        </div>
                        <div class="instruction-txt -c">
                            <img src="./../assets/image/map2/instruction/txt-click.png" alt="">
                        </div>
                        <div class="instruction-leaf">
                            <img src="./../assets/image/map2/instruction/leaf.png" alt="">
                            <div class="instruction-finger -l">
                                <div></div>
                            </div>
                        </div>
                        <div class="instruction-txt -l">
                            <img src="./../assets/image/map2/instruction/txt-leaf.png" alt="">
                        </div>
                        <div class="instruction-list">
                            <span>食穀收集清單</span>
                            <div class="instruction-triangle -down"></div>
                        </div>
                    </div>
                    <div class="game-time"><span>30</span></div>
                </div>
                <div class="game-task">
                    <img src="./../assets/image/map2/instruction/task.png" alt="">
                </div>
            </div>
        </div>
        <div class="step-item" data-step="game">
            <div class="game">
                <div class="game-content">
                    <div class="game-stage" id="canvas-container"></div>
                    <div class="game-time"><span data-second>30</span></div>
                </div>
                <div class="game-task">
                    <div data-item="malt">
                        <img src="./../assets/image/map2/1.png" alt="">
                        <div>
                            麥芽
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="blackRice">
                        <img src="./../assets/image/map2/2.png" alt="">
                        <div>
                            黑米
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="barley">
                        <img src="./../assets/image/map2/3.png" alt="">
                        <div>
                            大麥
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="maize">
                        <img src="./../assets/image/map2/4.png" alt="">
                        <div>
                            玉蜀黍
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="shiitakeMushroom">
                        <img src="./../assets/image/map2/5.png" alt="">
                        <div>
                            香菇
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="persimmonLeaf">
                        <img src="./../assets/image/map2/6.png" alt="">
                        <div>
                            柿葉
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="step-item" data-step="level">
            <div class="card -score">
                <div class="card-wrap">
                    <div class="score">
                        <div class="score-tit">挑戰成績</div>
                        <div class="score-level">
                            <div>
                            </div>
                        </div>
                        <div class="score-desc"></div>
                        <div class="score-action">
                            <!-- 挑戰失敗無法抽“立即抽”與“大獎” -->
                            <button class="btn" data-share>分享至FB</button>
                            <button class="btn" data-share>分享至Line</button>
                            <a href="./game.html" class="btn">重玩一次</a>
                        </div>
                        <div class="score-note" data-share>完成分享才能抽大獎喔！</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block popups %}
<!-- 音效popup -->
<div class="popup -show" data-popup="music">
    <div class="popup-wrap">
        <div class="popup-content">
            <div class="music">
                請開啟音效<br>
                以獲得最佳遊戲體驗
            </div>
        </div>
        <div class="popup-action">
            <button class="btn" data-popup-close data-voice="close">關閉</button>
            <button class="btn" data-popup-close data-voice="open">開啟</button>
        </div>
    </div>
</div>
<audio id="audio" src="{{ '/assets/audio/morning-mist.mp4' | relativePath }}" loop></audio>
<!-- 挑戰成功popup -->
<div class="popup" data-popup="success">
    <div class="popup-wrap">
        <div class="popup-tit">挑戰成功</div>
        <div class="popup-content">
            <div class="result">
                <div class="result-tit">
                    <span>找到</span>
                    <div class="result-num">
                        <span data-found></span>
                    </div>
                    <span>個食穀</span>
                </div>
                <div class="result-txt">
                    恭喜你尋穀成功！<br>
                    立即抽一瓶零咖啡因十六茶<br>
                    今晚伴你安心好眠!
                </div>
            </div>
        </div>
        <div class="popup-action">
            <!-- 流程示意用，實際請移除[data-popup-btn="win"] -->
            <button class="btn" data-popup-btn="win" data-popup-close>立即抽</button>
        </div>
    </div>
</div>
<!-- 挑戰失敗popup -->
<div class="popup" data-popup="fail">
    <div class="popup-wrap">
        <div class="popup-tit -dark">挑戰失敗</div>
        <div class="popup-content">
            <div class="result">
                <div class="result-tit">
                    <span>還差</span>
                    <div class="result-num">
                        <span data-notfound></span>
                    </div>
                    <span>個食穀</span>
                </div>
                <div class="result-txt">
                    別氣餒！<br>
                    來罐天然零咖啡因十六茶，<br>
                    清香回甘帶走壞心情，<br>
                    陪你再戰一局！
                </div>
            </div>
        </div>
        <div class="popup-action">
            <button class="btn" data-step-btn="level" data-popup-close>下一步</button>
        </div>
    </div>
</div>
<!-- 請依照實際抽獎結果顯示相對應popup -->
<!-- 中獎popup -->
<!-- 若中獎，
    請在[data-popup="win"]加上class .-show 以顯示popup，
    以及<body>加上class .-isPopupOpen
-->
<div class="popup" data-popup="win">
    <div class="popup-wrap">
        <div class="popup-tit">恭喜中獎</div>
        <div class="popup-content">
            <div class="lottery">
                <div class="lottery-name">獲得十六茶乙瓶</div>
                <div class="lottery-pic">
                    <img src="./../assets/image/product/16cha.webp" alt="">
                </div>
                <div class="lottery-code">
                    兌換序號
                    <p>XOOXXOXOXOOXXOXOOXO</p>
                </div>
                <div class="lottery-note">請至「我的贈品」查詢獎品喔 !</div>
            </div>
        </div>
        <div class="popup-action">
            <button class="btn" data-step-btn="level" data-popup-close>下一步</button>
        </div>
    </div>
</div>
<!-- 沒中獎popup -->
<!-- 若沒中獎，
    請在[data-popup="sad"]加上class .-show 以顯示popup，
    以及<body>加上class .-isPopupOpen
-->
<div class="popup" data-popup="sad">
    <div class="popup-wrap">
        <div class="popup-tit -fail">殘念&nbsp;&nbsp;&nbsp;沒中獎</div>
        <div class="popup-content">
            <div class="fail">
                可惜！這次沒中獎~<br>
                再試一次，好運就會降臨！
            </div>
        </div>
        <div class="popup-action">
            <button class="btn" data-step-btn="level" data-popup-close>下一步</button>
        </div>
    </div>
</div>
{% endblock %}

{% block styles %}
<link rel="stylesheet" href="./../assets/css/game.min.css">
{% endblock %}

{% block pluginScripts %}
<script src="./../assets/lib/gsap.min.js"></script>
<script src="./../assets/lib/pixi.min.js"></script>
{% endblock %}

{% block scripts %}
<script>
    // 這邊可以取得使用者蒐集到的各個數量
    // 若有需要得知挑戰結果來做一些事，可參考<body>上的class，成功會加上.-success，失敗會加上.-fail
    var score = {
        // 麥芽
        malt: 0,
        // 黑米
        blackRice: 0,
        // 大麥
        barley: 0,
        // 玉蜀黍
        maize: 0,
        // 香菇
        shiitakeMushroom: 0,
        // 柿葉
        persimmonLeaf: 0
    };

    var mapNum = 2;
</script>
<script src="./../assets/js/game.min.js"></script>
{% endblock %}