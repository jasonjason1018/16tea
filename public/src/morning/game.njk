{% extends './_layouts/_layout.tmpl' %}

{% block logo %}
<a href="{{ '/index.html' | relativePath }}">
    <img src="{{ '/assets/image/layout/logo.png' | relativePath }}" alt="">
</a>
<div class="header-subject">
    <img src="{{ '/assets/image/layout/subject-dk.png' | relativePath }}" alt="">
</div>
{% endblock %}

{% block content %}
<main class="main -f01">
    <div class="step">
        <div class="step-item -active" data-step="intro">
            <div class="intro">
                <div class="intro-wrap">
                    <div class="intro-tit">晨光森林</div>
                    <div class="intro-txt">
                        晨曦透過樹梢灑下溫暖光芒<br>
                        讓療癒之森充滿寧靜與能量<br>
                        這裡藏著能喚醒活力、帶來好氣色的食穀<br>
                        快來一起尋找吧！
                    </div>
                    <div class="intro-16">
                        {%- for item in range(0, 16) %}
                        <img src="/assets/image/other/16/{{loop.index}}.png" class="intro-item" alt="">
                        {%- endfor %}
                    </div>
                </div>
                <button class="intro-btn" data-step-btn="task"></button>
            </div>
        </div>
        <div class="step-item" data-step="task">
            <div class="card -task">
                <div class="card-wrap">
                    <div class="task">
                        <div class="task-tit">
                            請在限時30秒內<br>
                            完成收集以下食穀與數量
                        </div>
                        <div class="task-content">
                            <div class="task-item">
                                <img class="task-pic" src="/assets/image/map1/1.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">紅豆</div>
                                    <div class="task-desc">不靠戀愛氣色好，靠紅豆剛剛好</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="/assets/image/map1/2.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">桑葉</div>
                                    <div class="task-desc">痘走元氣來，找回好活力</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="/assets/image/map1/3.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">薏仁</div>
                                    <div class="task-desc">白得自然，靠薏仁養出來</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="/assets/image/map1/4.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">紅棗</div>
                                    <div class="task-desc">棗回好氣色，自帶美顏濾鏡</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                            <div class="task-item">
                                <img class="task-pic" src="/assets/image/map1/5.png" alt="">
                                <div class="task-txt">
                                    <div class="task-name">黑豆</div>
                                    <div class="task-desc">吃豆不會老，元氣滿點不顯老</div>
                                </div>
                                <div class="task-num"></div>
                            </div>
                        </div>
                        <div class="task-action">
                            <button class="btn" data-step-btn="instruction">開始挑戰</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="step-item" data-step="instruction">
            <div class="game -instruction" data-step-btn="game">
                <div class="game-content">
                    <div class="instruction">
                        <div class="instruction-time">
                            <div class="instruction-triangle"></div>
                            <span>限時30秒</span>
                        </div>
                        <div class="instruction-click">
                            <img src="/assets/image/map1/instruction/item.png" alt="">
                            <div class="instruction-finger -c">
                                <div></div>
                            </div>
                        </div>
                        <div class="instruction-txt -c">
                            <img src="/assets/image/map1/instruction/txt-click.png" alt="">
                        </div>
                        <div class="instruction-leaf">
                            <img src="/assets/image/map1/instruction/leaf.png" alt="">
                            <div class="instruction-finger -l">
                                <div></div>
                            </div>
                        </div>
                        <div class="instruction-txt -l">
                            <img src="/assets/image/map1/instruction/txt-leaf.png" alt="">
                        </div>
                        <div class="instruction-list">
                            <span>食穀收集清單</span>
                            <div class="instruction-triangle -down"></div>
                        </div>
                    </div>
                    <div class="game-time"><span>30</span></div>
                </div>
                <div class="game-task">
                    <img src="/assets/image/map1/instruction/task.png" alt="">
                </div>
            </div>
        </div>
        <div class="step-item" data-step="game">
            <div class="game">
                <div class="game-content">
                    <div class="game-stage" id="canvas-container"></div>
                    <div class="game-time"><span data-second>30</span></div>
                </div>
                <div class="game-task">
                    <div data-item="redBean">
                        <img src="/assets/image/map1/1.png" alt="">
                        <div>
                            紅豆
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="mulberryLeaf">
                        <img src="/assets/image/map1/2.png" alt="">
                        <div>
                            桑葉
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="jobsTears">
                        <img src="/assets/image/map1/3.png" alt="">
                        <div>
                            薏仁
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="redDate">
                        <img src="/assets/image/map1/4.png" alt="">
                        <div>
                            紅棗
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                    <div data-item="blackBean">
                        <img src="/assets/image/map1/5.png" alt="">
                        <div>
                            黑豆
                            <p><span data-num>0</span>/<span data-target></span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="step-item" data-step="level">
            <div class="card -score">
                <div class="card-wrap">
                    <div class="score">
                        <div class="score-tit">挑戰成績</div>
                        <div class="score-level">
                            <div>
                            </div>
                        </div>
                        <div class="score-desc"></div>
                        <div class="score-action">
                            <!-- 挑戰失敗無法抽“立即抽”與“大獎” -->
                            <button class="btn" data-share>分享至FB</button>
                            <button class="btn" data-share>分享至Line</button>
                            <a href="./game.html" class="btn">重玩一次</a>
                        </div>
                        <div class="score-note" data-share>完成分享才能抽大獎喔！</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block popups %}
<!-- 音效popup -->
<div class="popup -show" data-popup="music">
    <div class="popup-wrap">
        <div class="popup-content">
            <div class="music">
                請開啟音效<br>
                以獲得最佳遊戲體驗
            </div>
        </div>
        <div class="popup-action">
            <button class="btn" data-popup-close data-voice="close">關閉</button>
            <button class="btn" data-popup-close data-voice="open">開啟</button>
        </div>
    </div>
</div>
<audio id="audio" src="{{ '/assets/audio/morning-mist.mp4' | relativePath }}" loop></audio>
<!-- 挑戰成功popup -->
<div class="popup" data-popup="success">
    <div class="popup-wrap">
        <div class="popup-tit">挑戰成功</div>
        <div class="popup-content">
            <div class="result">
                <div class="result-tit">
                    <span>找到</span>
                    <div class="result-num">
                        <span data-found></span>
                    </div>
                    <span>個食穀</span>
                </div>
                <div class="result-txt">
                    恭喜你尋穀成功！<br>
                    立即抽一瓶零咖啡因十六茶<br>
                    今晚伴你安心好眠!
                </div>
            </div>
        </div>
        <div class="popup-action">
            <!-- 流程示意用，實際請移除[data-popup-btn="win"] -->
            <button class="btn" data-popup-btn="win" data-popup-close>立即抽</button>
        </div>
    </div>
</div>
<!-- 挑戰失敗popup -->
<div class="popup" data-popup="fail">
    <div class="popup-wrap">
        <div class="popup-tit -dark">挑戰失敗</div>
        <div class="popup-content">
            <div class="result">
                <div class="result-tit">
                    <span>還差</span>
                    <div class="result-num">
                        <span data-notfound></span>
                    </div>
                    <span>個食穀</span>
                </div>
                <div class="result-txt">
                    別氣餒！<br>
                    來罐天然零咖啡因十六茶，<br>
                    清香回甘帶走壞心情，<br>
                    陪你再戰一局！
                </div>
            </div>
        </div>
        <div class="popup-action">
            <button class="btn" data-step-btn="level" data-popup-close>下一步</button>
        </div>
    </div>
</div>
<!-- 請依照實際抽獎結果顯示相對應popup -->
<!-- 中獎popup -->
<!-- 若中獎，
    請在[data-popup="win"]加上class .-show 以顯示popup，
    以及<body>加上class .-isPopupOpen
-->
<div class="popup" data-popup="win">
    <div class="popup-wrap">
        <div class="popup-tit">恭喜中獎</div>
        <div class="popup-content">
            <div class="lottery">
                <div class="lottery-name">獲得十六茶乙瓶</div>
                <div class="lottery-pic">
                    <img src="/assets/image/product/16cha.webp" alt="">
                </div>
                <div class="lottery-code">
                    兌換序號
                    <p>XOOXXOXOXOOXXOXOOXO</p>
                </div>
                <div class="lottery-note">請至「我的贈品」查詢獎品喔 !</div>
            </div>
        </div>
        <div class="popup-action">
            <button class="btn" data-step-btn="level" data-popup-close>下一步</button>
        </div>
    </div>
</div>
<!-- 沒中獎popup -->
<!-- 若沒中獎，
    請在[data-popup="sad"]加上class .-show 以顯示popup，
    以及<body>加上class .-isPopupOpen
-->
<div class="popup" data-popup="sad">
    <div class="popup-wrap">
        <div class="popup-tit -fail">殘念&nbsp;&nbsp;&nbsp;沒中獎</div>
        <div class="popup-content">
            <div class="fail">
                可惜！這次沒中獎~<br>
                再試一次，好運就會降臨！
            </div>
        </div>
        <div class="popup-action">
            <button class="btn" data-step-btn="level" data-popup-close>下一步</button>
        </div>
    </div>
</div>
{% endblock %}

{% block styles %}
<link rel="stylesheet" href="/assets/css/game.min.css">
{% endblock %}

{% block pluginScripts %}
<script src="/assets/lib/gsap.min.js"></script>
<script src="/assets/lib/pixi.min.js"></script>
{% endblock %}

{% block scripts %}
<script>
    // 這邊可以取得使用者蒐集到的各個數量
    // 若有需要得知挑戰結果來做一些事，可參考<body>上的class，成功會加上.-success，失敗會加上.-fail
    var score = {
        // 紅豆
        redBean: 0,
        // 桑葉
        mulberryLeaf: 0,
        // 薏仁
        jobsTears: 0,
        // 紅棗
        redDate: 0,
        // 黑豆
        blackBean: 0
    };

    var mapNum = 1;
</script>
<script src="/assets/js/game.min.js"></script>
{% endblock %}